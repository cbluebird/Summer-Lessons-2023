# 一般查询
+ GORM 提供了 `First`、`Take`、`Last` 方法，以便从数据库中检索单个对象
+ 提供了 `Find` 方法，以便从数据库中检索全部对象
```go
var user User
var users []User

// 根据主键查询第一条记录
db.First(&user)
//// SELECT * FROM users ORDER BY id LIMIT 1;

// 获取一条记录，没有指定排序字段
db.Take(&user)
//// SELECT * FROM users LIMIT 1;

// 根据主键查询最后一条记录
db.Last(&user)
//// SELECT * FROM users ORDER BY id DESC LIMIT 1;

// 查询指定的某条记录(仅当主键为整型时可用)
db.First(&user, 10)
//// SELECT * FROM users WHERE id = 10;

// 查询所有的记录
db.Find(&users)
//// SELECT * FROM users;

result := db.First(&user)
result.RowsAffected // 返回找到的记录数
result.Error        // 返回错误
```
+ 注意：
	+ 当目标对象有一个主键值时，将使用主键构建查询条件
	+ 使用 `First` 等方法查询单个记录时，如果查询不到数据会返回 `ErrRecordNotFound` 错误
	+ 使用 `Find` 查询时，查询不到数据不会返回错误
# 条件
## string 条件
```go
// 获取第一条匹配的记录
db.Where("name = ?", "jinzhu").First(&user)  
// SELECT * FROM users WHERE name = 'jinzhu' ORDER BY id LIMIT 1;  
  
// 获取所有匹配的记录
db.Where("name <> ?", "jinzhu").Find(&users)  
// SELECT * FROM users WHERE name <> 'jinzhu';  
  
// IN
db.Where("name IN ?", []string{"jinzhu", "jinzhu 2"}).Find(&users)  
// SELECT * FROM users WHERE name IN ('jinzhu','jinzhu 2');  
  
// LIKE
db.Where("name LIKE ?", "%jin%").Find(&users)  
// SELECT * FROM users WHERE name LIKE '%jin%';  
  
// AND
db.Where("name = ? AND age >= ?", "jinzhu", "22").Find(&users)  
// SELECT * FROM users WHERE name = 'jinzhu' AND age >= 22;  
  
// Time
db.Where("updated_at > ?", lastWeek).Find(&users)  
// SELECT * FROM users WHERE updated_at > '2000-01-01 00:00:00';  
  
// BETWEEN
db.Where("created_at BETWEEN ? AND ?", lastWeek, today).Find(&users)  
// SELECT * FROM users WHERE created_at BETWEEN '2000-01-01 00:00:00' AND '2000-01-08 00:00:00';
```
## struct & Map 条件
```go
// Struct  
db.Where(&User{Name: "jinzhu", Age: 20}).First(&user)  
// SELECT * FROM users WHERE name = "jinzhu" AND age = 20 ORDER BY id LIMIT 1;
  
// Map  
db.Where(map[string]interface{}{"name": "jinzhu", "age": 20}).Find(&users)  
// SELECT * FROM users WHERE name = "jinzhu" AND age = 20;  
  
// Slice of primary keys  
db.Where([]int64{20, 21, 22}).Find(&users)  
// SELECT * FROM users WHERE id IN (20, 21, 22);
```
注意：使用 struct 查询时，GORM 将仅使用非零字段进行查询，这意味着如果你的字段的值为 `0` `''` `false` 或其他零值时，将不会用于构建查询条件，例如：
```go
db.Where(&User{Name: "jinzhu", Age: 0}).Find(&users)
//// SELECT * FROM users WHERE name = "jinzhu";
```
要在查询条件中包含零值，可以使用 map，它会将所有键值作为查询条件包含在内，例如：
```go
db.Where(map[string]interface{}{"Name": "jinzhu", "Age": 0}).Find(&users)  
// SELECT * FROM users WHERE name = "jinzhu" AND age = 0;
```
## 指定结构体查询字段
在使用 struct 进行搜索时，指定在查询条件中要使用结构体中的哪些特定值，例如：
```go
db.Where(&User{Name: "jinzhu"}, "name", "Age").Find(&users)  
// SELECT * FROM users WHERE name = "jinzhu" AND age = 0;  
  
db.Where(&User{Name: "jinzhu"}, "Age").Find(&users)  
// SELECT * FROM users WHERE age = 0;
```
## 内联条件
```go
// Get by primary key if it were a non-integer type  
db.First(&user, "id = ?", "string_primary_key")  
// SELECT * FROM users WHERE id = 'string_primary_key';  
  
// Plain SQL  
db.Find(&user, "name = ?", "jinzhu")  
// SELECT * FROM users WHERE name = "jinzhu";  
  
db.Find(&users, "name <> ? AND age > ?", "jinzhu", 20)  
// SELECT * FROM users WHERE name <> "jinzhu" AND age > 20;  
  
// Struct  
db.Find(&users, User{Age: 20}) 
// SELECT * FROM users WHERE age = 20;  

// Map  
db.Find(&users, map[string]interface{}{"age": 20})  
// SELECT * FROM users WHERE age = 20;
```
## Not 条件
```go
db.Not("name = ?", "jinzhu").First(&user)  
// SELECT * FROM users WHERE NOT name = "jinzhu" ORDER BY id LIMIT 1;  
  
// Not In  
db.Not(map[string]interface{}{"name": []string{"jinzhu", "jinzhu 2"}}).Find(&users)  
// SELECT * FROM users WHERE name NOT IN ("jinzhu", "jinzhu 2");  
  
// Struct  
db.Not(User{Name: "jinzhu", Age: 18}).First(&user)  
// SELECT * FROM users WHERE name <> "jinzhu" AND age <> 18 ORDER BY id LIMIT 1;  
  
// Not In slice of primary keys  
db.Not([]int64{1,2,3}).First(&user)  
// SELECT * FROM users WHERE id NOT IN (1,2,3) ORDER BY id LIMIT 1;
```
## Or 条件
```go
db.Where("role = ?", "admin").Or("role = ?", "super_admin").Find(&users)  
// SELECT * FROM users WHERE role = 'admin' OR role = 'super_admin';  
  
// Struct  
db.Where("name = 'jinzhu'").Or(User{Name: "jinzhu 2", Age: 18}).Find(&users)  
// SELECT * FROM users WHERE name = 'jinzhu' OR (name = 'jinzhu 2' AND age = 18);  
  
// Map  
db.Where("name = 'jinzhu'").Or(map[string]interface{}{"name": "jinzhu 2", "age": 18}).Find(&users)  
// SELECT * FROM users WHERE name = 'jinzhu' OR (name = 'jinzhu 2' AND age = 18);
```
# 选择特定字段
`Select` 允许指定要从数据库中检索的字段，没有 `Select` GORM 将默认选择所有字段
```go
db.Select("name", "age").Find(&users)  
// SELECT name, age FROM users;  
  
db.Select([]string{"name", "age"}).Find(&users)  
// SELECT name, age FROM users;
```
# 排序
```go
db.Order("age desc, name").Find(&users)
// SELECT * FROM users ORDER BY age desc, name;  
  
// Multiple orders
db.Order("age desc").Order("name").Find(&users)  
// SELECT * FROM users ORDER BY age desc, name;
```
# Limit & Offset
`Limit` 指定要检索的最大记录数，`Offset` 指定在开始返回记录之前要跳过的记录数
```go
db.Limit(3).Find(&users)  
// SELECT * FROM users LIMIT 3;  
  
// -1 表示检索所有记录
db.Limit(10).Find(&users1).Limit(-1).Find(&users2)  
// SELECT * FROM users LIMIT 10; (users1)  
// SELECT * FROM users; (users2)  
  
db.Limit(10).Offset(5).Find(&users)  
// SELECT * FROM users OFFSET 5 LIMIT 10;
```
注意：`Offset` 不能单独使用，要和 `Limit` 要一起使用

# [更多](https://gorm.io/zh_CN/docs/query.html)
