+ 以查询到记录为基础  
+ 更新的记录不存在不会报 error

# 保存所有字段
`Save` 会保存所有的字段，即使字段是零值
```go
db.First(&user)  
  
user.Name = "jinzhu 2"  
user.Age = 100  
db.Save(&user)  
// UPDATE users SET name='jinzhu 2', age=100, updated_at = '2013-11-17 21:34:10' WHERE id=111;
```
+ 如果保存值不包含主键（或者主键值在数据库中不存在），它将执行 Create 创建
+ 主键存在则会执行更新保存所有字段
```go
db.Save(&User{Name: "jinzhu", Age: 100})  
// INSERT INTO `users` (`name`,`age`,`update_at`) VALUES ("jinzhu",100,"0000-00-00 00:00:00")  
  
db.Save(&User{ID: 1, Name: "jinzhu", Age: 100})  
// UPDATE `users` SET `name`="jinzhu",`age`=100,`update_at`="0000-00-00 00:00:00" WHERE `id` = 1
```

# 更新单个列
+ 需要通过 `Model` 函数来传入要更新的模型，主要是用来确定表名
+ 当使用该方法并且其值具有主值时，主键将用于构建条件
```go
// 根据条件更新
db.Model(&User{}).Where("active = ?", true).Update("name", "hello")  
// UPDATE users SET name='hello', updated_at='2013-11-17 21:34:10' WHERE active=true;  

// 根据主键更新
// User's ID is `111`:
db.Model(&user).Update("name", "hello")  
// UPDATE users SET name='hello', updated_at='2013-11-17 21:34:10' WHERE id=111;

// 根据条件和主键更新
db.Model(&user).Where("active = ?", true).Update("name", "hello")  
// UPDATE users SET name='hello', updated_at='2013-11-17 21:34:10' WHERE id=111 AND active=true;
```

# 更新多列
+ 如果要更新多个字段的话，可以使用 `Updates` 函数，该函数需要传入一个结构体或 map
+ 在使用结构体时，不会更新零值，如果要更新的话，需要使用 map 或者更新选定字段
```go
// 用结构体更新  
db.Model(&user).Updates(User{Name: "hello", Age: 18, Active: false})  
// UPDATE users SET name='hello', age=18, updated_at = '2013-11-17 21:34:10' WHERE id = 111;
  
// 用 map 更新
db.Model(&user).Updates(map[string]interface{}{"name": "hello", "age": 18, "active": false}) 
// UPDATE users SET name='hello', age=18, active=false, updated_at='2013-11-17 21:34:10' WHERE id=111;
```

# 更新选定字段
如果要在更新时更新所选字段或忽略某些字段，可以使用 `select` 和 `omit`
```go
// Select with Map  
// User's ID is `111`:  
db.Model(&user).Select("name").Updates(map[string]interface{}{"name": "hello", "age": 18, "active": false})
// UPDATE users SET name='hello' WHERE id=111;  
  
db.Model(&user).Omit("name").Updates(map[string]interface{}{"name": "hello", "age": 18, "active": false})  
// UPDATE users SET age=18, active=false, updated_at='2013-11-17 21:34:10' WHERE id=111;
  
// Select with Struct (select zero value fields)  
db.Model(&user).Select("Name", "Age").Updates(User{Name: "new_name", Age: 0})
// UPDATE users SET name='new_name', age=0 WHERE id=111;  
  
// Select all fields (select all fields include zero value fields)  
db.Model(&user).Select("*").Updates(User{Name: "jinzhu", Role: "admin", Age: 0})
  
// Select all fields but omit Role (select all fields include zero value fields)
db.Model(&user).Select("*").Omit("Role").Updates(User{Name: "jinzhu", Role: "admin", Age: 0})
```

# 批量更新
如果我们没有指定主键值，GORM 将执行批量更新 `Model`，更新所有符合条件的记录
```go
// Update with struct
db.Model(User{}).Where("role = ?", "admin").Updates(User{Name: "hello", Age: 18})
// UPDATE users SET name='hello', age=18 WHERE role = 'admin';  
  
// Update with map  
db.Model(User{}).Where("id IN ?", []int{10, 11}).Updates(map[string]interface{}{"name": "hello", "age": 18})  
// UPDATE users SET name='hello', age=18 WHERE id IN (10, 11);
```

# [更新 ](https://gorm.io/zh_CN/docs/update.html)

