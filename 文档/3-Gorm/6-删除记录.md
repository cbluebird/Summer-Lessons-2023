+ 以查询到记录为基础
+ 删除的记录不存在不会报 error

# 删除一条记录
删除一条记录时，删除对象需要指定主键，否则会触发批量删除
**注**：删除的记录不存在不会报 error 
```go
// User 的 ID 是 `10`
db.Delete(&user)
// DELETE from users where id = 10;

// 带额外条件的删除
db.Where("name = ?", "jinzhu").Delete(&user)
// DELETE from users where id = 10 AND name = "jinzhu";
```

# 根据主键删除
GORM 允许通过主键和内联条件来删除对象
```go
db.Delete(&User{}, 10)  
// DELETE FROM users WHERE id = 10;
  
db.Delete(&users, []int{1,2,3})  
// DELETE FROM users WHERE id IN (1,2,3);

// 内联条件
db.Delete(&user{}, "name = ?", "jinzhu")  
// DELETE FROM users WHERE name = "jinzhu";
```

# 批量删除
如果指定的值不包括主属性，那么 GORM 会执行批量删除，它将删除所有匹配的记录
```go
db.Where("name LIKE ?", "%jinzhu%").Delete(&User{})  
// DELETE from users where name LIKE "%jinzhu%";  

db.Delete(&User{}, "name LIKE ?", "%jinzhu%")
// DELETE from users where name LIKE "%jinzhu%";
```

## 阻止全局删除
当你试图执行不带任何条件的批量删除时，GORM将不会运行并返回`ErrMissingWhereClause` 错误
如果一定要这么做，你必须添加一些条件，或者使用原生SQL，或者开启`AllowGlobalUpdate` 模式，如下例：
```go
db.Delete(&User{}).Error
// gorm.ErrMissingWhereClause

// 需要主键值
db.Delete(&[]User{{Name: "jinzhu1"}, {Name: "jinzhu2"}}).Error 
// gorm.ErrMissingWhereClause  
  
db.Where("1 = 1").Delete(&User{})  
// DELETE FROM `users` WHERE 1=1  

// 原生 SQL
db.Exec("DELETE FROM users")  
// DELETE FROM users  
  
db.Session(&gorm.Session{AllowGlobalUpdate: true}).Delete(&User{})  
// DELETE FROM users
```

# 软删除
如果你的模型包含了 `gorm.DeletedAt` 字段（该字段也被包含在 `gorm.Model` 中），那么该模型将会自动获得软删除的能力
当调用 `Delete` 时，GORM并不会从数据库中删除该记录，而是将该记录的 `DeleteAt` 设置为当前时间，而后的一般查询方法将无法查找到此条记录
```go
// user's ID is `111`  
db.Delete(&user)  
// UPDATE users SET deleted_at="2013-10-29 10:23" WHERE id = 111;  
  
// 批量删除
db.Where("age = ?", 20).Delete(&User{})  
// UPDATE users SET deleted_at="2013-10-29 10:23" WHERE age = 20;  
  
// 软删除的记录在查询时会被忽略  
db.Where("age = 20").Find(&user)  
// SELECT * FROM users WHERE age = 20 AND deleted_at IS NULL;
```
如果你并不想嵌套 `gorm.Model`，你也可以像下方例子那样开启软删除特性：
```go
type User struct {  
  ID      int  
  Deleted gorm.DeletedAt  
  Name    string  
}
```

## 查找被软删除的记录
你可以使用 `Unscoped` 来查询到被软删除的记录
```go
db.Unscoped().Where("age = 20").Find(&users)
// SELECT * FROM users WHERE age = 20;
```

## 永久删除
你可以使用 `Unscoped` 来永久删除匹配的记录
```go
// user's ID is `10`
db.Unscoped().Delete(&user)  
// DELETE FROM users WHERE id=10;
```

# [更多](https://gorm.io/zh_CN/docs/delete.html)
